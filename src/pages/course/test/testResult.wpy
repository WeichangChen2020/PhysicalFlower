<style type="less">
.swiper image {
  width: 100%;
  height: 70%;
}
</style>
<template>
  <view style="margin-bottom:30px;text-align:center;">测试结果</view>
  <swiper  class='swiper image' style="height:900rpx" current = "{{current}}" @change = "change">
    <swiper-item wx:for="{{quizResultList}}" wx:for-item="page" wx:key="*this">
      <image src="{{page.img}}"/>
      <view style="display:block"> 
       <view>正确答案：{{page.correctAnswer}}</view>
       <view>你的答案：{{page.submitAnswer}}</view>
      </view>
    </swiper-item>
  </swiper>
</template>
<script>
  import wepy from 'wepy'

  // 通过继承自wepy.page的类创建页面逻辑
  export default class testSearch extends wepy.page {
    config = {
      navigationBarTitleText: '测试详情'
    }
    // 可用于页面模板绑定的数据
    data = {
      idQuiz: 0,
      idUser: 0,
      quizResultList: [],
      // 是否采用衔接滑动
      circular: false,
      // 是否显示画板指示点
      indicatorDots: false,
      // 选中点的颜色
      indicatorcolor: '#000',
      // 是否竖直
      vertical: false,
      // 是否自动切换
      autoplay: true,
      // 自动切换的间隔
      interval: 2500,
      // 滑动动画时长毫秒
      duration: 100,
      // 图片宽度
      imgwidth: 750,
      // 默认
      current: 0
    };

    // 事件处理函数(集中保存在methods对象中)
    methods = {
    }
    // 页面的生命周期函数
    onLoad(e) {
      let that = this
      that.idQuiz = e.idQuiz
      that.idUser = e.idUser
      that.getQuizresult()
    };
    getQuizresult() {
      let app = this.$parent
      let that = this
      var postData = {
        idQuiz: that.idQuiz,
        idUser: that.idUser
      }
      app.request('Quiz.getStuQuizDetail', postData, 'Loading...')
      .then((res) => {
        for (var i = 0; i < res.data.data.length; i++) {
          that.quizResultList.push(res.data.data[i].quiz_info)
          that.$apply()
        }
        console.log(that.quizResultList)
        for (i = 0; i < that.quizResultList.length; i++) {
          if (that.quizResultList[i].answer === '16') {
            that.quizResultList[i].correctAnswer = 'A'
          } else if (that.quizResultList[i].answer === '32') {
            that.quizResultList[i].correctAnswer = 'B'
          } else if (that.quizResultList[i].answer === '64') {
            that.quizResultList[i].correctAnswer = 'C'
          } else if (that.quizResultList[i].answer === '128') {
            that.quizResultList[i].correctAnswer = 'D'
          }
          that.$apply()
        }
        for (i = 0; i < that.quizResultList.length; i++) {
          if (that.quizResultList[i].stu_submit === '16') {
            that.quizResultList[i].submitAnswer = 'A'
          } else if (that.quizResultList[i].stu_submit === '32') {
            that.quizResultList[i].submitAnswer = 'B'
          } else if (that.quizResultList[i].stu_submit === '64') {
            that.quizResultList[i].submitAnswer = 'C'
          } else if (that.quizResultList[i].stu_submit === '128') {
            that.quizResultList[i].submitAnswer = 'D'
          }
          that.$apply()
        }
      })
    }
  }
</script>
